package me.moomoo.anarchyexploitfixes.config;

import me.moomoo.anarchyexploitfixes.AnarchyExploitFixes;
import org.bukkit.configuration.InvalidConfigurationException;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;

import java.io.File;
import java.io.IOException;

public class LanguageCache {

    private final FileConfiguration fileConfiguration;
    boolean addedMissing = false;
    public String noPermission, command_Whitelist_BadCommand, youNeedToBeXBlocksAwayToTP, nickResetOnly, thisIsNotTheWorldsize, chat_ChatCoFix_SpecifyAPlayer,
            chat_antispam_slowmodeNotif, chat_antispam_tooManyMsgsNotif, chat_antispam_duplicateMsgsNotif, joinMessage, leaveMessage, firstJoinMessage,
            masked_KickMessage, witherSpawningDisabledInRadius, enabledConnectionMsgs, disabledConnectionMsgs, disablePacketElytraFly, global_YouAreFlyingIn,
            global_New, global_New_Color, global_Old, global_Old_Color, global_Speed, global_DisabledLowTPS, global_TooFastLowTPS, global_TooFastChunkInfo,
            global_TooFast, global_DisabledHere, global_Chunks, ceiling_DisabledHere, ceiling_Chunks, ceiling_YouAreFlyingIn, ceiling_New, ceiling_New_Color,
            ceiling_Old, ceiling_Old_Color, ceiling_Speed, ceiling_DisabledLowTPS, ceiling_TooFastLowTPS, ceiling_TooFastChunkInfo, ceiling_TooFast,
            spawn_DisabledHere, spawn_YouAreFlyingIn, spawn_New, spawn_New_Color, spawn_Old, spawn_Old_Color, spawn_Speed, spawn_DisabledLowTPS, spawn_TooFast,
            spawn_TooFastChunkInfo, spawn_Chunks, stopSpammingLevers;

    public LanguageCache(String lang) {
        AnarchyExploitFixes plugin = AnarchyExploitFixes.getInstance();
        File langFile = new File(plugin.getDataFolder() + File.separator + "lang", lang + ".yml");
        fileConfiguration = new YamlConfiguration();

        if (!langFile.exists()) {
            langFile.getParentFile().mkdirs();
            plugin.saveResource("lang" + File.separator + lang + ".yml", false);
        }
        try {
            fileConfiguration.load(langFile);

            // No Permission
            this.noPermission = getStringTranslation("no-permission", "You don't have permission to use this command.");
            // Chat
            this.chat_antispam_slowmodeNotif = getStringTranslation("chat.antispam.slowmode-notification", "&cYou need to wait a bit before sending another message.");
            this.chat_antispam_tooManyMsgsNotif = getStringTranslation("chat.antispam.too-many-messages-notification", "&cYou're sending too many messages at a time.");
            this.chat_antispam_duplicateMsgsNotif = getStringTranslation("chat.antispam.same-message-notification", "&cYou're sending too many duplicate messages at a time.");
            this.chat_ChatCoFix_SpecifyAPlayer = getStringTranslation("chat.chatco-fix-specify-player", "&cYou didn't add a player name...");
            // Command Whitelist
            this.command_Whitelist_BadCommand = getStringTranslation("command-whitelist.bad-command", "&4Bad command. Type /help for a list of commands.");
            // Join & Leave Messages
            this.joinMessage = getStringTranslation("join-leave-messages.join", "&7%player% joined the game.");
            this.leaveMessage = getStringTranslation("join-leave-messages.leave", "&7%player% left the game.");
            this.enabledConnectionMsgs = getStringTranslation("join-leave-messages.enabled-connection-msgs", "&7Enabled connection msgs");
            this.disabledConnectionMsgs = getStringTranslation("join-leave-messages.disabled-connection-msgs", "&7Disabled connection msgs");
            // First Join Message
            this.firstJoinMessage = getStringTranslation("join-leave-messages.first-join", "&7%player% joined the game for the first time. They are %players_num% to join.");
            // Kick Message
            this.masked_KickMessage = getStringTranslation("kicks.masked-kick-message", "&6Disconnected");
            // 1b1t Options
            this.youNeedToBeXBlocksAwayToTP = getStringTranslation("1b1t-options.you-need-to-be-x-blocks-away-to-tp", "&9You need to be %blocks% blocks away from spawn to teleport!");
            this.nickResetOnly = getStringTranslation("1b1t-options.nickname-reset-only", "&9You can't change your nick but you may reset it by typing /nick off if you have a legacy nick!");
            this.thisIsNotTheWorldsize = getStringTranslation("1b1t-options.not-worldsize", "&7This is not the world size, for world size type /stats");
            // Disable Wither Spawning at Spawn
            this.witherSpawningDisabledInRadius = getStringTranslation("withers.disabled-at-spawn", "&4Wither spawning is disabled in a radius of %radius% blocks around spawn.");
            // Packet ElytraFly message
            this.disablePacketElytraFly = getStringTranslation("elytra.disable-packet-elytrafly", "&cDisable Packet Elytra Fly.");
            /*
                Elytra Speed
            */
            // Global
            this.global_DisabledHere = getStringTranslation("elytra.elytra-speed.global.disabled-here", "&cElytras are currently disabled.");
            this.global_YouAreFlyingIn = getStringTranslation("elytra.elytra-speed.global.you-are-flying-in", "&7You are flying in %neworold% &7%chunks%");
            this.global_New = getStringTranslation("elytra.elytra-speed.global.new", "new");
            this.global_New_Color = getStringTranslation("elytra.elytra-speed.global.color-newchunks", "&4");
            this.global_Old = getStringTranslation("elytra.elytra-speed.global.old", "old");
            this.global_Old_Color = getStringTranslation("elytra.elytra-speed.global.color-oldchunks", "&a");
            this.global_Speed = getStringTranslation("elytra.elytra-speed.global.speed", "&7Speed: %speed% / %maxspeed%");
            this.global_DisabledLowTPS = getStringTranslation("elytra.elytra-speed.global.disabled-low-tps", "&cElytras are currently disabled because the tps is lower than %tps%.");
            this.global_TooFastLowTPS = getStringTranslation("elytra.elytra-speed.global.going-too-fast-low-tps", "&cElytra speed is reduced during low tps. Turn down your settings.");
            this.global_TooFastChunkInfo = getStringTranslation("elytra.elytra-speed.global.going-too-fast-chunkinfo", "&cTurn down your settings. Elytra speed is restricted in %neworold% %chunks%");
            this.global_TooFast = getStringTranslation("elytra.elytra-speed.global.going-too-fast", "&cTurn down your settings. Elytra speed is restricted on this server.");
            this.global_Chunks = getStringTranslation("elytra.elytra-speed.global.chunks", "chunks");
            // Nether Ceiling
            this.ceiling_DisabledHere = getStringTranslation("elytra.elytra-speed.nether-ceiling.disabled-here", "&cElytras are disabled on the nether ceiling.");
            this.ceiling_YouAreFlyingIn = getStringTranslation("elytra.elytra-speed.nether-ceiling.you-are-flying-in", "&7You are flying in %neworold% &7%chunks%");
            this.ceiling_New = getStringTranslation("elytra.elytra-speed.nether-ceiling.new", "new");
            this.ceiling_New_Color = getStringTranslation("elytra.elytra-speed.nether-ceiling.color-newchunks", "&4");
            this.ceiling_Old = getStringTranslation("elytra.elytra-speed.nether-ceiling.old", "old");
            this.ceiling_Old_Color = getStringTranslation("elytra.elytra-speed.nether-ceiling.color-oldchunks", "&a");
            this.ceiling_Speed = getStringTranslation("elytra.elytra-speed.nether-ceiling.speed", "&7Speed: %speed% / %maxspeed%");
            this.ceiling_DisabledLowTPS = getStringTranslation("elytra.elytra-speed.nether-ceiling.disabled-low-tps", "&cElytras are currently disabled because the tps is lower than %tps%.");
            this.ceiling_TooFastLowTPS = getStringTranslation("elytra.elytra-speed.nether-ceiling.going-too-fast-low-tps", "&cElytra speed is reduced during low tps. Turn down your settings.");
            this.ceiling_TooFastChunkInfo = getStringTranslation("elytra.elytra-speed.nether-ceiling.going-too-fast-chunkinfo", "&cTurn down your settings. Elytra speed is restricted in %neworold% %chunks%");
            this.ceiling_TooFast = getStringTranslation("elytra.elytra-speed.nether-ceiling.going-too-fast", "&cTurn down your settings. Elytra speed is restricted on the nether ceiling.");
            this.ceiling_Chunks = getStringTranslation("elytra.elytra-speed.nether-ceiling.chunks", "ceiling chunks");
            // Spawn
            this.spawn_DisabledHere = getStringTranslation("elytra.elytra-speed.spawn.disabled-here", "&cElytras are disabled in a range of &6%range% &cblocks around spawn.");
            this.spawn_YouAreFlyingIn = getStringTranslation("elytra.elytra-speed.spawn.you-are-flying-in", "&7You are flying in %neworold% &7%chunks%");
            this.spawn_New = getStringTranslation("elytra.elytra-speed.spawn.new", "new");
            this.spawn_New_Color = getStringTranslation("elytra.elytra-speed.spawn.color-newchunks", "&4");
            this.spawn_Old = getStringTranslation("elytra.elytra-speed.spawn.old", "old");
            this.spawn_Old_Color = getStringTranslation("elytra.elytra-speed.spawn.color-oldchunks", "&a");
            this.spawn_Speed = getStringTranslation("elytra.elytra-speed.spawn.speed", "&7Speed: %speed% / %maxspeed%");
            this.spawn_DisabledLowTPS = getStringTranslation("elytra.elytra-speed.spawn.disabled-low-tps", "&cElytras are currently disabled because the tps is lower than %tps%.");
            this.spawn_TooFastChunkInfo = getStringTranslation("elytra.elytra-speed.spawn.going-too-fast-chunkinfo", "&cElytra speed is restricted in %neworold% %chunks% in a radius of %radius% blocks.");
            this.spawn_TooFast = getStringTranslation("elytra.elytra-speed.nether-ceiling.going-too-fast", "&cElytra speed is restricted in a radius of %radius% blocks around spawn.");
            this.spawn_Chunks = getStringTranslation("elytra.elytra-speed.spawn.chunks", "spawn chunks");
            // Redstone
            this.stopSpammingLevers = getStringTranslation("redstone.stop-spamming-levers", "&cStop spamming levers.");

            if (addedMissing) fileConfiguration.save(langFile);
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InvalidConfigurationException e) {
            AnarchyExploitFixes.getLog().warning("Translation file " + langFile + " is not formatted properly. Skipping it.");
        }
    }

    public String getStringTranslation(String path, String defaultTranslation) {
        String translation = fileConfiguration.getString(path);
        if (translation == null) {
            fileConfiguration.set(path, defaultTranslation);
            addedMissing = true;
            return defaultTranslation;
        }
        return translation;
    }
}
